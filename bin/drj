#!/usr/bin/env bash
set -euo pipefail
if [ $# -lt 1 ]; then echo "Usage: drj <apv.json | raw-json>"; exit 2; fi
arg="$1"
if [[ "$arg" == \{* || "$arg" == \[* ]]; then tmp="$(mktemp)"; printf '%s' "$arg" > "$tmp"; trap 'rm -f "$tmp"' EXIT; exec poetry run diff-risk "$tmp" -f json --no-exit-by-risk; fi
exec poetry run diff-risk "$arg" -f json --no-exit-by-risk
