from dataclasses import dataclass
from typing import Dict, List

SEVERITIES: List[str] = ["CRITICAL", "HIGH", "MEDIUM", "LOW", "INFO"]


@dataclass
class Summary:
    total: int
    by_severity: Dict[str, int]
    worst: str
    risk_level: str  # "red" | "yellow" | "green"


def to_markdown(s: Summary) -> str:
    # Zero-state limpio y profesional
    if s.total == 0:
        return (
            "# Diff Risk Dashboard ğŸŸ¢ â€” No findings\n\n"
            "> âœ… No findings detected (all severities are 0).\n\n"
            "> Generated by diff-risk-dashboard CLI\n"
        )

    dot = "ğŸ”´" if s.risk_level == "red" else "ğŸŸ¡" if s.risk_level == "yellow" else "ğŸŸ¢"
    lines = [
        f"# Diff Risk Dashboard {dot} â€” Worst: **{s.worst}**",
        "",
        "| Severity | Count |",
        "|---|---:|",
    ]
    for sev in SEVERITIES:
        lines.append(f"| {sev} | {s.by_severity.get(sev, 0)} |")
    lines.append(f"| **TOTAL** | **{s.total}** |")
    lines.append("\n> Generated by diff-risk-dashboard CLI")
    return "\n".join(lines)
